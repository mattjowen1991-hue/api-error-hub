<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hubstaff API Support Hub</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #10b981;
            --primary-dark: #059669;
            --primary-glow: rgba(16, 185, 129, 0.15);
            --accent: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --purple: #8b5cf6;
            
            --bg-dark: #0a0f1a;
            --bg-card: #111827;
            --bg-elevated: #1f2937;
            --bg-input: #0d1117;
            
            --text-primary: #f9fafb;
            --text-secondary: #9ca3af;
            --text-muted: #6b7280;
            
            --border: #374151;
            --border-light: #4b5563;
            
            --radius: 12px;
            --radius-sm: 8px;
            --radius-lg: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Subtle grid background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(rgba(16, 185, 129, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(16, 185, 129, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Header */
        header {
            text-align: center;
            padding: 40px 20px;
            margin-bottom: 30px;
            position: relative;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 20px var(--primary-glow);
        }

        header h1 {
            font-size: 2.25rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--primary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Stats Banner */
        .stats-banner {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 24px;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary);
            font-family: 'JetBrains Mono', monospace;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 12px 24px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            color: var(--text-secondary);
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab:hover {
            border-color: var(--primary);
            color: var(--text-primary);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 4px 20px var(--primary-glow);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Panels */
        .panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 24px;
            margin-bottom: 24px;
        }

        .panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .panel-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .panel-icon {
            width: 36px;
            height: 36px;
            background: var(--bg-elevated);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        /* Grid Layouts */
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        @media (max-width: 1000px) {
            .two-column {
                grid-template-columns: 1fr;
            }
        }

        /* Textarea */
        textarea {
            width: 100%;
            height: 280px;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 16px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            resize: vertical;
            line-height: 1.7;
            transition: border-color 0.2s;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-glow);
        }

        textarea::placeholder {
            color: var(--text-muted);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius);
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            box-shadow: 0 4px 15px var(--primary-glow);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px var(--primary-glow);
        }

        .btn-secondary {
            background: var(--bg-elevated);
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--border-light);
            color: var(--text-primary);
        }

        .btn-small {
            padding: 8px 14px;
            font-size: 0.8rem;
            border-radius: var(--radius-sm);
        }

        .btn-copy {
            background: var(--bg-elevated);
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .btn-copy:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-copy.copied {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .button-row {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        /* Search Input */
        .search-container {
            position: relative;
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 14px 16px 14px 48px;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: inherit;
            transition: all 0.2s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-glow);
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 18px;
        }

        /* Category Filters */
        .category-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .filter-chip {
            padding: 8px 16px;
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: 50px;
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-chip:hover {
            border-color: var(--primary);
            color: var(--text-primary);
        }

        .filter-chip.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        /* Category Colors */
        .cat-auth { --cat-color: #ef4444; }
        .cat-validation { --cat-color: #f59e0b; }
        .cat-resource { --cat-color: #3b82f6; }
        .cat-rate { --cat-color: #8b5cf6; }
        .cat-time { --cat-color: #f97316; }
        .cat-system { --cat-color: #6b7280; }

        .category-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: rgba(var(--cat-color-rgb), 0.15);
            color: var(--cat-color);
        }

        .cat-auth .category-badge { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .cat-validation .category-badge { background: rgba(245, 158, 11, 0.15); color: #f59e0b; }
        .cat-resource .category-badge { background: rgba(59, 130, 246, 0.15); color: #3b82f6; }
        .cat-rate .category-badge { background: rgba(139, 92, 246, 0.15); color: #8b5cf6; }
        .cat-time .category-badge { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .cat-system .category-badge { background: rgba(107, 114, 128, 0.15); color: #9ca3af; }

        /* Error Cards */
        .error-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 16px;
            max-height: 600px;
            overflow-y: auto;
            padding-right: 8px;
        }

        .error-grid::-webkit-scrollbar {
            width: 6px;
        }

        .error-grid::-webkit-scrollbar-track {
            background: var(--bg-dark);
            border-radius: 3px;
        }

        .error-grid::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        .error-card {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .error-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .error-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .error-code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent);
        }

        .error-key {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .error-message {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .has-guidance {
            position: relative;
        }

        .has-guidance::after {
            content: '‚úì';
            position: absolute;
            top: 12px;
            right: 12px;
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            color: white;
        }

        /* Results Section */
        .results-placeholder {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .results-placeholder .icon {
            font-size: 4rem;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        /* Extracted Info Grid */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }

        .info-card {
            background: var(--bg-input);
            border-radius: var(--radius-sm);
            padding: 12px 16px;
            border-left: 3px solid var(--primary);
        }

        .info-card.empty {
            border-left-color: var(--border);
            opacity: 0.6;
        }

        .info-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .info-value {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: var(--accent);
        }

        .info-value.text {
            color: var(--text-primary);
            font-family: inherit;
        }

        /* Match Cards */
        .match-card {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 16px;
        }

        .match-card.exact {
            border-color: var(--primary);
            box-shadow: 0 0 30px var(--primary-glow);
        }

        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .match-codes {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .match-code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent);
        }

        .match-key {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--text-muted);
            background: var(--bg-input);
            padding: 4px 12px;
            border-radius: var(--radius-sm);
        }

        .match-badge {
            padding: 4px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-exact {
            background: var(--primary);
            color: white;
        }

        .badge-related {
            background: var(--info);
            color: white;
        }

        .match-message {
            background: var(--bg-input);
            border-left: 3px solid var(--accent);
            padding: 12px 16px;
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            margin-bottom: 16px;
            font-size: 0.95rem;
        }

        /* Support Guidance */
        .guidance-box {
            background: rgba(16, 185, 129, 0.08);
            border: 1px solid rgba(16, 185, 129, 0.25);
            border-radius: var(--radius);
            padding: 20px;
        }

        .guidance-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            color: var(--primary);
            font-weight: 600;
        }

        .guidance-text {
            color: var(--text-secondary);
            margin-bottom: 12px;
            line-height: 1.7;
        }

        .guidance-steps {
            margin: 0;
            padding-left: 20px;
        }

        .guidance-steps li {
            color: var(--text-secondary);
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .no-guidance {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: var(--radius);
            padding: 16px;
            color: var(--accent);
        }

        /* Response Template */
        .response-template {
            margin-top: 16px;
            background: var(--bg-input);
            border-radius: var(--radius);
            overflow: hidden;
        }

        .response-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: var(--bg-elevated);
            border-bottom: 1px solid var(--border);
        }

        .response-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .response-body {
            padding: 16px;
            font-size: 0.9rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.visible {
            display: flex;
        }

        .modal-content {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            max-width: 700px;
            width: 100%;
            max-height: 85vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            animation: modalIn 0.2s ease;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
        }

        .modal-title {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            line-height: 1;
            transition: color 0.2s;
        }

        .modal-close:hover {
            color: var(--text-primary);
        }

        .modal-body {
            padding: 24px;
            overflow-y: auto;
        }

        /* Usage Stats */
        .usage-panel {
            background: var(--bg-elevated);
            border-radius: var(--radius);
            padding: 16px;
            margin-top: 24px;
        }

        .usage-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .usage-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .usage-clear {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 0.8rem;
            cursor: pointer;
            text-decoration: underline;
        }

        .usage-clear:hover {
            color: var(--danger);
        }

        .usage-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
        }

        .usage-item:last-child {
            border-bottom: none;
        }

        .usage-code {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: var(--accent);
        }

        .usage-count {
            background: var(--bg-input);
            padding: 2px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Help Modal Styles */
        .help-content {
            max-width: 900px;
        }

        .help-nav {
            display: flex;
            gap: 8px;
            padding: 16px 24px;
            background: var(--bg-elevated);
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
        }

        .help-nav-btn {
            padding: 8px 16px;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .help-nav-btn:hover {
            border-color: var(--primary);
            color: var(--text-primary);
        }

        .help-nav-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .help-section {
            margin-bottom: 32px;
        }

        .help-section h3 {
            color: var(--primary);
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .help-section h4 {
            color: var(--text-primary);
            margin: 20px 0 10px;
            font-size: 0.95rem;
        }

        .help-section p {
            color: var(--text-secondary);
            margin-bottom: 12px;
            line-height: 1.7;
        }

        .help-section ul, .help-section ol {
            color: var(--text-secondary);
            margin-left: 20px;
            margin-bottom: 16px;
        }

        .help-section li {
            margin-bottom: 6px;
            line-height: 1.6;
        }

        .help-table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
            font-size: 0.9rem;
        }

        .help-table th, .help-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .help-table th {
            background: var(--bg-elevated);
            color: var(--text-primary);
            font-weight: 600;
        }

        .help-table td {
            color: var(--text-secondary);
        }

        .help-table code {
            background: var(--bg-input);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--accent);
        }

        .help-callout {
            background: var(--bg-elevated);
            border-radius: var(--radius);
            padding: 16px;
            margin: 16px 0;
            border-left: 3px solid var(--primary);
        }

        .help-callout.warning {
            border-left-color: var(--accent);
        }

        .help-callout.info {
            border-left-color: var(--info);
        }

        .help-callout-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .help-tab-content {
            display: none;
        }

        .help-tab-content.active {
            display: block;
        }

        .example-box {
            background: var(--bg-input);
            border-radius: var(--radius);
            padding: 16px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--text-secondary);
            white-space: pre-wrap;
            overflow-x: auto;
            margin: 12px 0;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 30px 20px;
            margin-top: 40px;
            border-top: 1px solid var(--border);
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        footer a {
            color: var(--primary);
            text-decoration: none;
            cursor: pointer;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* No Results */
        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .no-results .icon {
            font-size: 3rem;
            margin-bottom: 12px;
            opacity: 0.5;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--bg-card);
            border: 1px solid var(--primary);
            border-radius: var(--radius);
            padding: 12px 20px;
            color: var(--text-primary);
            font-size: 0.9rem;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
            z-index: 2000;
            display: none;
            animation: toastIn 0.3s ease;
        }

        .toast.visible {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        @keyframes toastIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Match legend */
        .match-legend {
            display: flex;
            gap: 20px;
            margin-bottom: 16px;
            font-size: 0.8rem;
            color: var(--text-muted);
            flex-wrap: wrap;
        }

        .match-legend span {
            display: flex;
            align-items: center;
            gap: 6px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">‚ö°</div>
                <h1>Hubstaff API Support Hub</h1>
            </div>
            <p>Your complete toolkit for diagnosing API errors and helping customers</p>
            
            <div class="stats-banner">
                <div class="stat-item">
                    <div class="stat-value">47</div>
                    <div class="stat-label">Error Codes</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">6</div>
                    <div class="stat-label">Categories</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="guidanceCount">15</div>
                    <div class="stat-label">With Guidance</div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <div class="nav-tabs">
            <button class="nav-tab active" data-tab="analyzer">
                <span>üîç</span> Message Analyzer
            </button>
            <button class="nav-tab" data-tab="browser">
                <span>üìö</span> Error Browser
            </button>
            <button class="nav-tab" data-tab="quick-ref">
                <span>‚ö°</span> Quick Reference
            </button>
        </div>

        <!-- Message Analyzer Tab -->
        <div class="tab-content active" id="analyzer-tab">
            <div class="two-column">
                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <div class="panel-icon">üìã</div>
                            <span>Customer Message</span>
                        </div>
                    </div>
                    <textarea id="customerMessage" placeholder="Paste the customer's message here...

Example:
When attempting to create a task in a project linked to Redmine, we receive:

{
  &quot;code&quot;: &quot;invalid_params&quot;,
  &quot;error_code&quot;: 11000,
  &quot;error&quot;: &quot;Can not create a task for a project with a task integration&quot;
}"></textarea>
                    <div class="button-row">
                        <button class="btn btn-primary" onclick="analyzeMessage()">
                            üîç Analyze Message
                        </button>
                        <button class="btn btn-secondary" onclick="clearAnalysis()">
                            ‚úï Clear
                        </button>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <div class="panel-icon">üìä</div>
                            <span>Analysis Results</span>
                        </div>
                    </div>
                    
                    <div id="noAnalysis" class="results-placeholder">
                        <div class="icon">üîç</div>
                        <p>Paste a customer message and click "Analyze" to identify API errors</p>
                    </div>

                    <div id="resultsSection" style="display: none;">
                        <div id="extractedInfo"></div>
                        
                        <div class="match-legend">
                            <span><span class="match-badge badge-exact">Exact</span> Error found in message</span>
                            <span><span class="match-badge badge-related">Related</span> Suggested by context</span>
                        </div>
                        
                        <div id="matchedErrors"></div>
                    </div>

                    <div class="usage-panel" id="usagePanel" style="display: none;">
                        <div class="usage-header">
                            <span class="usage-title">üìä Your Most Searched Errors</span>
                            <button class="usage-clear" onclick="clearUsageStats()">Clear</button>
                        </div>
                        <div id="usageList"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Error Browser Tab -->
        <div class="tab-content" id="browser-tab">
            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">
                        <div class="panel-icon">üìö</div>
                        <span>All Error Codes</span>
                    </div>
                    <span id="errorCount" style="color: var(--text-muted); font-size: 0.9rem;">47 errors</span>
                </div>

                <div class="search-container">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="search-input" id="errorSearch" placeholder="Search by code, key, or message..." oninput="filterErrors()">
                </div>

                <div class="category-filters">
                    <button class="filter-chip active" data-category="all" onclick="setCategory('all')">All</button>
                    <button class="filter-chip" data-category="auth" onclick="setCategory('auth')">üîê Auth (10xxx)</button>
                    <button class="filter-chip" data-category="validation" onclick="setCategory('validation')">‚úì Validation (11xxx)</button>
                    <button class="filter-chip" data-category="resource" onclick="setCategory('resource')">üìÅ Resource (12xxx)</button>
                    <button class="filter-chip" data-category="rate" onclick="setCategory('rate')">‚è±Ô∏è Rate Limit (13xxx)</button>
                    <button class="filter-chip" data-category="time" onclick="setCategory('time')">‚è∞ Time/Activity (14xxx)</button>
                    <button class="filter-chip" data-category="system" onclick="setCategory('system')">‚öôÔ∏è System (15xxx)</button>
                </div>

                <div class="error-grid" id="errorGrid"></div>
            </div>
        </div>

        <!-- Quick Reference Tab -->
        <div class="tab-content" id="quick-ref-tab">
            <div class="two-column">
                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <div class="panel-icon">üéØ</div>
                            <span>Most Common Errors</span>
                        </div>
                    </div>
                    <div id="commonErrors"></div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <div class="panel-icon">üìñ</div>
                            <span>HTTP Status Quick Guide</span>
                        </div>
                    </div>
                    <div class="help-table-container">
                        <table class="help-table">
                            <thead>
                                <tr>
                                    <th>Code</th>
                                    <th>Meaning</th>
                                    <th>Customer Explanation</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>200</code></td>
                                    <td>OK</td>
                                    <td>Request successful ‚úì</td>
                                </tr>
                                <tr>
                                    <td><code>400</code></td>
                                    <td>Bad Request</td>
                                    <td>Missing or invalid data in request</td>
                                </tr>
                                <tr>
                                    <td><code>401</code></td>
                                    <td>Unauthorized</td>
                                    <td>API token is invalid or expired</td>
                                </tr>
                                <tr>
                                    <td><code>403</code></td>
                                    <td>Forbidden</td>
                                    <td>Token works but lacks permission</td>
                                </tr>
                                <tr>
                                    <td><code>404</code></td>
                                    <td>Not Found</td>
                                    <td>Resource doesn't exist or no access</td>
                                </tr>
                                <tr>
                                    <td><code>429</code></td>
                                    <td>Rate Limited</td>
                                    <td>Too many requests - slow down</td>
                                </tr>
                                <tr>
                                    <td><code>500</code></td>
                                    <td>Server Error</td>
                                    <td>Issue on Hubstaff's side</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">
                        <div class="panel-icon">üìù</div>
                        <span>Response Templates</span>
                    </div>
                </div>
                <div id="responseTemplates"></div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <p>Hubstaff API Support Hub v2.0 ‚Ä¢ <a onclick="openHelpModal()">üìñ User Guide</a> ‚Ä¢ Built for Support Excellence</p>
    </footer>

    <!-- Error Detail Modal -->
    <div class="modal-overlay" id="errorModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Error Details</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <!-- Help Modal -->
    <div class="modal-overlay" id="helpModal">
        <div class="modal-content help-content">
            <div class="modal-header">
                <h3 class="modal-title">üìñ Support User Guide</h3>
                <button class="modal-close" onclick="closeHelpModal()">&times;</button>
            </div>
            
            <div class="help-nav">
                <button class="help-nav-btn active" onclick="showHelpTab('quickstart')">üöÄ Quick Start</button>
                <button class="help-nav-btn" onclick="showHelpTab('analyzer')">üìã Analyzer</button>
                <button class="help-nav-btn" onclick="showHelpTab('categories')">üìö Categories</button>
                <button class="help-nav-btn" onclick="showHelpTab('glossary')">üìò Glossary</button>
                <button class="help-nav-btn" onclick="showHelpTab('tips')">üí° Pro Tips</button>
            </div>
            
            <div class="modal-body">
                <!-- Quick Start -->
                <div class="help-tab-content active" id="help-quickstart">
                    <div class="help-section">
                        <h3>üéØ What This Tool Does</h3>
                        <p>This hub helps you quickly diagnose API errors from customer messages and provide accurate troubleshooting guidance. No API expertise required!</p>
                        
                        <div class="help-callout">
                            <div class="help-callout-title">‚ö° 30-Second Guide</div>
                            <ol>
                                <li><strong>Copy</strong> the customer's message (email, Slack, ticket)</li>
                                <li><strong>Paste</strong> it into the Message Analyzer</li>
                                <li><strong>Click</strong> "Analyze Message"</li>
                                <li><strong>Read</strong> the green guidance box for troubleshooting steps</li>
                                <li><strong>Copy</strong> the response template if provided</li>
                            </ol>
                        </div>
                    </div>
                    
                    <div class="help-section">
                        <h3>üè∑Ô∏è Understanding Match Types</h3>
                        <table class="help-table">
                            <tr>
                                <th>Badge</th>
                                <th>Meaning</th>
                                <th>Action</th>
                            </tr>
                            <tr>
                                <td><span class="match-badge badge-exact">Exact</span></td>
                                <td>Error code found in message</td>
                                <td>High confidence - use guidance</td>
                            </tr>
                            <tr>
                                <td><span class="match-badge badge-related">Related</span></td>
                                <td>Suggested by keywords</td>
                                <td>Verify with customer first</td>
                            </tr>
                        </table>
                    </div>

                    <div class="help-section">
                        <h3>üì° Data Source</h3>
                        <p>All 47 error codes come from the official Hubstaff API endpoint:</p>
                        <div class="example-box">GET https://api.hubstaff.com/v2/error_codes</div>
                        <p style="margin-top: 12px;">Documentation: <a href="https://developer.hubstaff.com/docs/hubstaff_v2#tag/errors" target="_blank" style="color: var(--primary);">developer.hubstaff.com/docs/hubstaff_v2#tag/errors</a></p>
                    </div>
                </div>

                <!-- Analyzer Help -->
                <div class="help-tab-content" id="help-analyzer">
                    <div class="help-section">
                        <h3>üìã Using the Message Analyzer</h3>
                        <p>The analyzer automatically extracts error information from customer messages, even from raw JSON or plain text descriptions.</p>
                        
                        <h4>What It Extracts</h4>
                        <table class="help-table">
                            <tr><th>Field</th><th>Example</th><th>Purpose</th></tr>
                            <tr><td>Error Code</td><td><code>11000</code></td><td>Specific error number</td></tr>
                            <tr><td>Error Key</td><td><code>invalid_params</code></td><td>Human-readable identifier</td></tr>
                            <tr><td>HTTP Status</td><td><code>400</code></td><td>Web response code</td></tr>
                            <tr><td>Endpoint</td><td><code>/v2/tasks</code></td><td>API feature being used</td></tr>
                            <tr><td>Context</td><td>task, project</td><td>Keywords for matching</td></tr>
                        </table>

                        <h4>Example Error Format</h4>
                        <p>Customers typically paste errors that look like this:</p>
                        <div class="example-box">{
  "code": "invalid_params",
  "error_code": 11000,
  "error": "Can not create a task for a project with a task integration"
}</div>
                    </div>
                </div>

                <!-- Categories Help -->
                <div class="help-tab-content" id="help-categories">
                    <div class="help-section">
                        <h3>üìö Error Categories</h3>
                        <table class="help-table">
                            <tr><th>Category</th><th>Range</th><th>Common Causes</th></tr>
                            <tr><td>üîê Auth</td><td>10000-10999</td><td>Token issues, permissions</td></tr>
                            <tr><td>‚úì Validation</td><td>11000-11999</td><td>Bad data, duplicates</td></tr>
                            <tr><td>üìÅ Resource</td><td>12000-12999</td><td>Not found, no access</td></tr>
                            <tr><td>‚è±Ô∏è Rate Limit</td><td>13000-13999</td><td>Too many requests</td></tr>
                            <tr><td>‚è∞ Time/Activity</td><td>14000-14999</td><td>Time entries, timesheets</td></tr>
                            <tr><td>‚öôÔ∏è System</td><td>15000-15999</td><td>Server errors, timeouts</td></tr>
                        </table>

                        <div class="help-callout info" style="margin-top: 20px;">
                            <div class="help-callout-title">‚ÑπÔ∏è Important: Error Code Coverage</div>
                            <p><strong>Current state:</strong> Structured error codes (with <code>error_code</code> numbers) are currently only returned by <strong>time entry creation endpoints</strong>.</p>
                            <p style="margin-top: 8px;"><strong>General errors:</strong> Auth/permission errors (10xxx) and resource errors (12xxx like "not_found") work across <strong>all API endpoints</strong>.</p>
                            <p style="margin-top: 8px;"><strong>Future:</strong> Engineering is working to add structured error codes to all Public API endpoints.</p>
                        </div>
                    </div>
                </div>

                <!-- Glossary -->
                <div class="help-tab-content" id="help-glossary">
                    <div class="help-section">
                        <h3>üìò API Terms Explained</h3>
                        <table class="help-table">
                            <tr><th>Term</th><th>Simple Explanation</th></tr>
                            <tr><td><strong>API</strong></td><td>A way for software to talk to Hubstaff programmatically</td></tr>
                            <tr><td><strong>Endpoint</strong></td><td>A specific address like <code>/v2/projects</code> or <code>/v2/tasks</code></td></tr>
                            <tr><td><strong>Token</strong></td><td>A secret key that identifies the user making API requests</td></tr>
                            <tr><td><strong>PAT</strong></td><td>Personal Access Token - a long-lived token for API access</td></tr>
                            <tr><td><strong>OAuth</strong></td><td>A secure authorization method used by Hubstaff's API</td></tr>
                            <tr><td><strong>JSON</strong></td><td>Data format like <code>{"key": "value"}</code></td></tr>
                            <tr><td><strong>Rate Limit</strong></td><td>Max requests allowed - Hubstaff allows 350/minute</td></tr>
                            <tr><td><strong>Scope</strong></td><td>What a token can do (<code>hubstaff:read</code> vs <code>hubstaff:write</code>)</td></tr>
                            <tr><td><strong>Pagination</strong></td><td>Splitting large results into pages to avoid timeouts</td></tr>
                        </table>

                        <h4 style="margin-top: 24px;">HTTP Status Codes</h4>
                        <table class="help-table">
                            <tr><th>Code</th><th>Meaning</th><th>Customer Explanation</th></tr>
                            <tr><td><code>200</code></td><td>OK</td><td>Request worked! ‚úì</td></tr>
                            <tr><td><code>400</code></td><td>Bad Request</td><td>Something wrong with the request data</td></tr>
                            <tr><td><code>401</code></td><td>Unauthorized</td><td>Token is invalid or expired</td></tr>
                            <tr><td><code>403</code></td><td>Forbidden</td><td>Token works but no permission</td></tr>
                            <tr><td><code>404</code></td><td>Not Found</td><td>Resource doesn't exist or no access</td></tr>
                            <tr><td><code>429</code></td><td>Too Many Requests</td><td>Hit rate limit - slow down</td></tr>
                            <tr><td><code>500</code></td><td>Server Error</td><td>Problem on Hubstaff's side</td></tr>
                        </table>
                    </div>
                </div>

                <!-- Pro Tips -->
                <div class="help-tab-content" id="help-tips">
                    <div class="help-section">
                        <h3>üí° Pro Tips for API Support</h3>
                        
                        <div class="help-callout">
                            <div class="help-callout-title">üéØ Ask for the Full Error</div>
                            <p>If a customer just says "I got an error", ask them to send the complete error response including any JSON. The more detail, the faster you can help!</p>
                        </div>
                        
                        <div class="help-callout info">
                            <div class="help-callout-title">üìã Integration Errors (11000)</div>
                            <p>If error 11000 mentions "task integration", the customer is trying to create tasks via API for an integrated project (Jira, Redmine, Asana, etc.). <strong>Tasks must be created in the source system</strong>, not via the Hubstaff API - the integration syncs them automatically.</p>
                        </div>

                        <div class="help-callout info">
                            <div class="help-callout-title">‚è±Ô∏è Manual Time Approval (14001)</div>
                            <p>This is an <strong>organization policy setting</strong>, not a bug. If the org has "Require approval for manual time" enabled, time entries can't be added via API - they must go through the web app for manager approval.</p>
                        </div>

                        <div class="help-callout info">
                            <div class="help-callout-title">üö¶ Rate Limits (13000)</div>
                            <p>Hubstaff allows <strong>350 requests per minute</strong>. If customers hit this, suggest: adding delays between calls, implementing exponential backoff, caching responses, and checking the <code>X-RateLimit-Remaining</code> header.</p>
                        </div>
                        
                        <div class="help-callout warning">
                            <div class="help-callout-title">‚ö†Ô∏è When to Escalate</div>
                            <p>Escalate to engineering if you see:</p>
                            <ul style="margin: 8px 0 0 20px;">
                                <li>Persistent <strong>15000</strong> (system error) after customer retries</li>
                                <li>Persistent <strong>15001</strong> (timeout) even with small data requests</li>
                                <li>Any error that doesn't match the customer's described action</li>
                                <li>Errors appearing on endpoints where they shouldn't apply</li>
                            </ul>
                        </div>

                        <div class="help-callout">
                            <div class="help-callout-title">üìö Useful Links</div>
                            <p style="margin-bottom: 8px;"><strong>API Documentation:</strong> <a href="https://developer.hubstaff.com/docs/hubstaff_v2" target="_blank" style="color: var(--primary);">developer.hubstaff.com/docs/hubstaff_v2</a></p>
                            <p style="margin-bottom: 8px;"><strong>Authentication Guide:</strong> <a href="https://developer.hubstaff.com/authentication" target="_blank" style="color: var(--primary);">developer.hubstaff.com/authentication</a></p>
                            <p><strong>Error Codes Endpoint:</strong> <code>GET /v2/error_codes</code></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <span>‚úì</span>
        <span id="toastMessage">Copied to clipboard!</span>
    </div>

    <script>
        // =====================================================
        // ERROR CODES DATABASE
        // =====================================================
        const errorCodes = [
            {"code":10001,"key":"auth_not_authorized","message":"You do not have the access rights required to do this action."},
            {"code":10002,"key":"auth_bad_request","message":"The request was invalid."},
            {"code":10003,"key":"auth_forbidden","message":"You do not have permission to perform this action."},
            {"code":10004,"key":"auth_financials_forbidden","message":"Rates cannot be set - you don't have permission to manage financials."},
            {"code":11000,"key":"validation_invalid_params","message":"The provided parameters are invalid."},
            {"code":11001,"key":"validation_record_invalid","message":"Validation failed."},
            {"code":11002,"key":"validation_record_not_unique","message":"A record with these values already exists."},
            {"code":11003,"key":"validation_lock_version","message":"The record has been modified. Please refresh and try again."},
            {"code":11004,"key":"validation_duplicate_assignment","message":"Duplicate assignment is not allowed."},
            {"code":12000,"key":"resource_not_found","message":"The resource was not found."},
            {"code":12001,"key":"resource_update_in_progress","message":"Another update is currently in progress. Please try again in a few moments."},
            {"code":12002,"key":"resource_user_project_access","message":"User does not have access to the project."},
            {"code":12003,"key":"resource_user_task_access","message":"User does not have access to the task."},
            {"code":13000,"key":"rate_limit_exceeded","message":"Rate limit has been reached. Please wait before making your next request."},
            {"code":13001,"key":"rate_limit_invites","message":"Cannot create invites, organization has hit the rate limit."},
            {"code":14000,"key":"time_entry_create_error","message":"Failed to create time entry."},
            {"code":14001,"key":"time_entry_approval_required","message":"Manual time entries require approval and can't be added through the API. Please submit the manual time request via the web app for manager approval."},
            {"code":14002,"key":"time_entry_limits_reached","message":"Limit has been reached."},
            {"code":14003,"key":"time_entry_outdated","message":"The time entry has been modified. Please refresh and try again."},
            {"code":14004,"key":"time_entry_invalid","message":"The time entry is invalid."},
            {"code":14100,"key":"activity_cannot_overwrite","message":"Cannot overwrite existing client activity."},
            {"code":14101,"key":"activity_locked","message":"Cannot overwrite locked activity."},
            {"code":14102,"key":"activity_period_restricted","message":"Adding time for this period is restricted."},
            {"code":14103,"key":"activity_existing","message":"Cannot overwrite existing activity."},
            {"code":14104,"key":"activity_cannot_move","message":"Activity cannot be moved."},
            {"code":14105,"key":"activity_override_collision","message":"Conflicting activity detected. Please confirm the override."},
            {"code":14200,"key":"activity_invalid_project","message":"The user does not have access to this project."},
            {"code":14201,"key":"activity_invalid_task","message":"The task is not associated with the selected project or the user is not a member."},
            {"code":14202,"key":"activity_inactive_task","message":"The task is deleted, archived, or completed."},
            {"code":14203,"key":"activity_invalid_user","message":"Invalid user specified."},
            {"code":14204,"key":"activity_other_project","message":"There are other projects in this time range."},
            {"code":14205,"key":"activity_other_task","message":"There are other tasks in this time range."},
            {"code":14206,"key":"activity_project_not_accessible","message":"You do not have permission to modify time for projects in this range."},
            {"code":14300,"key":"activity_limit_exceeded","message":"The limit would be exceeded."},
            {"code":14301,"key":"activity_limit_reached","message":"The limit has already been reached."},
            {"code":14302,"key":"activity_dow_restriction","message":"Time tracking is restricted to certain days of the week."},
            {"code":14303,"key":"activity_shift_restriction","message":"Time tracking is only allowed during scheduled shifts."},
            {"code":14304,"key":"activity_project_limit","message":"Adding this time will exceed the project's budget."},
            {"code":14305,"key":"activity_project_limit_no_rate","message":"Time cannot be tracked because the project has a budget limit but member has no hourly rate set."},
            {"code":14400,"key":"activity_permission_denied","message":"You do not have permission to perform this action."},
            {"code":14401,"key":"activity_modify_disabled","message":"Time editing is disabled."},
            {"code":14402,"key":"activity_retention_policy","message":"Data is before the retention policy limit."},
            {"code":14403,"key":"activity_timesheet_locked","message":"You cannot add or change time unless your timesheet is open."},
            {"code":14404,"key":"activity_work_break_overlap","message":"Time entry overlaps with work breaks."},
            {"code":14405,"key":"activity_existing_screen","message":"A screenshot already exists for this time."},
            {"code":15000,"key":"system_unknown_error","message":"An unexpected error occurred."},
            {"code":15001,"key":"system_service_unavailable","message":"Server timeout. If your request involves pagination, consider decreasing the number of items per page."}
        ];

        // =====================================================
        // SUPPORT GUIDANCE DATABASE
        // =====================================================
        const supportGuidance = {
            10001: {
                title: "Authorization Issue",
                guidance: "The user's API token may not have the required permissions for this action.",
                steps: [
                    "Verify the user has the correct role in the organization (Owner, Admin, Manager, etc.)",
                    "Check if the token has the required scopes (hubstaff:read, hubstaff:write)",
                    "Confirm the user has access to the specific resource (project, team, etc.)"
                ],
                template: "This error indicates your API token doesn't have permission for this action. Please check:\n\n1. Your role in the organization (Settings ‚Üí Members)\n2. That your token has the required scopes\n3. That you have access to the specific project/resource\n\nIf you need elevated permissions, please contact your organization admin."
            },
            10003: {
                title: "Permission Denied",
                guidance: "The user's role doesn't allow this action.",
                steps: [
                    "Check the user's role in Organization Settings",
                    "Review what permissions are needed for this endpoint",
                    "If they need elevated access, they should contact their org admin"
                ],
                template: "Your current role doesn't have permission for this action. Organization admins can adjust permissions in Settings ‚Üí Members ‚Üí [Your Name] ‚Üí Permissions."
            },
            10004: {
                title: "Financials Permission Required",
                guidance: "Setting pay rates or bill rates requires 'Manage Financials' permission.",
                steps: [
                    "Only Owners and Admins with 'Manage Financials' can set rates",
                    "The user should contact their organization owner to get this permission",
                    "Check Organization Settings ‚Üí Members ‚Üí [User] ‚Üí Permissions"
                ],
                template: "Setting rates requires the 'Manage Financials' permission, which is only available to Owners and Admins with that specific permission enabled. Please contact your organization owner to request this access."
            },
            11000: {
                title: "Invalid Parameters",
                guidance: "The API request contains invalid or missing parameters. This is often seen when trying to create tasks in projects with external integrations.",
                steps: [
                    "If related to task creation with an integration (Jira, Redmine, Asana, etc.): Tasks MUST be created in the source system, not via the API",
                    "Check that all required fields are included in the request",
                    "Verify data types match what's expected (strings vs integers, date formats, etc.)",
                    "Review the specific endpoint documentation for required parameters"
                ],
                template: "When a project is connected to an external integration (like Jira or Redmine), tasks must be created in that external system rather than through the Hubstaff API. The integration will automatically sync tasks to Hubstaff. This is by design to maintain data consistency between systems."
            },
            11002: {
                title: "Duplicate Record",
                guidance: "A record with these values already exists in the system.",
                steps: [
                    "Check if the resource (user, project, task, etc.) already exists",
                    "If creating an assignment, verify the user isn't already assigned",
                    "Use a GET request first to check existing records"
                ],
                template: "A record with these values already exists in the system. Please check if the resource you're trying to create already exists, or if the user is already assigned to this project/task."
            },
            11003: {
                title: "Concurrent Modification",
                guidance: "The record was modified by someone else while the user was editing.",
                steps: [
                    "Fetch the latest version of the record and retry",
                    "This often happens with rapidly updated resources",
                    "Consider implementing optimistic locking in their integration"
                ],
                template: "This error occurs when the record was modified by someone else while you were editing. Please refresh the data and try your update again."
            },
            12000: {
                title: "Resource Not Found",
                guidance: "The requested resource doesn't exist or the user doesn't have access to it.",
                steps: [
                    "Verify the ID is correct (project_id, user_id, task_id, etc.)",
                    "Check if the resource was deleted or archived",
                    "Confirm the user has access to view this resource"
                ],
                template: "The resource you're looking for couldn't be found. Please verify:\n\n1. The ID is correct\n2. The resource hasn't been deleted or archived\n3. You have access to view this resource"
            },
            12002: {
                title: "Project Access Issue",
                guidance: "The user isn't a member of the specified project.",
                steps: [
                    "Add the user to the project in Settings ‚Üí Projects ‚Üí [Project] ‚Üí Members",
                    "Check if the project exists and is active",
                    "Verify they're using the correct project_id"
                ],
                template: "The user specified in the API request doesn't have access to this project. Please add them as a project member in Settings ‚Üí Projects ‚Üí [Project] ‚Üí Members, or verify you're using the correct project_id."
            },
            13000: {
                title: "Rate Limit Exceeded",
                guidance: "Too many API requests in a short period.",
                steps: [
                    "Implement exponential backoff in their integration",
                    "Current limit is 350 requests per minute",
                    "Check the X-RateLimit-* headers for limit details",
                    "Consider caching responses to reduce API calls"
                ],
                template: "You've exceeded the API rate limit of 350 requests per minute. To resolve this:\n\n1. Add delays between your API calls\n2. Implement exponential backoff for retries\n3. Check the X-RateLimit-Remaining header to monitor usage\n4. Consider caching responses to reduce API calls"
            },
            14001: {
                title: "Manual Time Approval Required",
                guidance: "The organization has enabled 'Require approval for manual time' which blocks API time entries.",
                steps: [
                    "This is an organization policy setting, not a bug",
                    "Manual time must be submitted through the web app for manager approval",
                    "If they need API access for time entries, the org admin must disable this setting",
                    "Check Organization Settings ‚Üí Time Tracking ‚Üí Manual time approval"
                ],
                template: "Your organization has 'Require approval for manual time' enabled, which means time entries can't be added directly through the API. Manual time must be submitted through the Hubstaff web app for manager approval. If you need to add time via API, your organization admin would need to disable this setting in Organization Settings ‚Üí Time Tracking."
            },
            14101: {
                title: "Activity Locked",
                guidance: "The time period is locked and cannot be modified.",
                steps: [
                    "Check if timesheets are locked for this period",
                    "Managers may need to unlock the timesheet first",
                    "Review the organization's timesheet locking policy"
                ],
                template: "The time period you're trying to modify is locked. A manager will need to unlock the timesheet before changes can be made. Please contact your manager or check with your organization admin about the timesheet locking policy."
            },
            14102: {
                title: "Period Restricted",
                guidance: "Adding time for this historical period is not allowed.",
                steps: [
                    "Check the organization's time entry restriction settings",
                    "Some orgs restrict adding time more than X days in the past",
                    "Contact org admin to adjust restriction or manually add the time"
                ],
                template: "Your organization restricts adding time entries for past dates beyond a certain limit. Please contact your organization admin if you need to add time for this period - they may be able to adjust the restriction or add the time manually."
            },
            14403: {
                title: "Timesheet Locked",
                guidance: "The user's timesheet for this period is locked/submitted.",
                steps: [
                    "The timesheet needs to be reopened by a manager",
                    "Check Settings ‚Üí Time Tracking ‚Üí Timesheet status",
                    "Manager can unlock via the Timesheets page"
                ],
                template: "Your timesheet for this period has been locked or submitted. A manager will need to reopen it before you can make changes. They can do this from the Timesheets page in the web app."
            },
            15000: {
                title: "System Error",
                guidance: "An unexpected server error occurred.",
                steps: [
                    "Try the request again after a few moments",
                    "If persistent, gather request details (endpoint, payload, headers)",
                    "Escalate to engineering with full reproduction steps"
                ],
                template: "An unexpected error occurred on our servers. Please try your request again in a few moments. If the issue persists, please let us know the exact endpoint you're calling and the data you're sending so we can investigate further."
            },
            15001: {
                title: "Server Timeout",
                guidance: "The request took too long to process.",
                steps: [
                    "Reduce the page_limit or date range in the request",
                    "For large data exports, use pagination",
                    "If querying reports, narrow the date range",
                    "Try the request during off-peak hours"
                ],
                template: "Your request timed out because it was processing too much data. Please try:\n\n1. Reducing the page_limit parameter (try 50 or less)\n2. Narrowing the date range\n3. Using pagination for large data sets\n\nIf you continue to have issues, please let us know the specific endpoint and parameters you're using."
            }
        };

        // =====================================================
        // RESPONSE TEMPLATES
        // =====================================================
        const responseTemplates = [
            {
                title: "Permission Errors (10001, 10003)",
                template: `This error indicates your API token doesn't have permission for this action. Please check:

1. Your role in the organization (Settings ‚Üí Members)
2. That your token has the required scopes
3. That you have access to the specific project/resource

If you need elevated permissions, please contact your organization admin.`
            },
            {
                title: "Rate Limits (13000)",
                template: `You've exceeded the API rate limit of 350 requests per minute. To resolve this:

1. Add delays between your API calls
2. Implement exponential backoff for retries
3. Check the X-RateLimit-Remaining header to monitor usage
4. Consider caching responses to reduce API calls`
            },
            {
                title: "Integration Task Errors (11000)",
                template: `When a project is connected to an external integration (like Jira or Redmine), tasks must be created in that external system rather than through the Hubstaff API. The integration will automatically sync tasks to Hubstaff. This is by design to maintain data consistency between systems.`
            },
            {
                title: "Manual Time Approval (14001)",
                template: `Your organization has "Require approval for manual time" enabled, which means time entries can't be added directly through the API. Manual time must be submitted through the Hubstaff web app for manager approval.

If you need to add time via API, your organization admin would need to disable this setting in Organization Settings ‚Üí Time Tracking.`
            }
        ];

        // =====================================================
        // UTILITY FUNCTIONS
        // =====================================================
        let currentCategory = 'all';

        function getCategory(code) {
            if (code >= 10000 && code < 11000) return 'auth';
            if (code >= 11000 && code < 12000) return 'validation';
            if (code >= 12000 && code < 13000) return 'resource';
            if (code >= 13000 && code < 14000) return 'rate';
            if (code >= 14000 && code < 15000) return 'time';
            if (code >= 15000 && code < 16000) return 'system';
            return 'unknown';
        }

        function getCategoryName(category) {
            const names = {
                'auth': 'Authentication',
                'validation': 'Validation',
                'resource': 'Resource',
                'rate': 'Rate Limit',
                'time': 'Time/Activity',
                'system': 'System'
            };
            return names[category] || 'Unknown';
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            toast.classList.add('visible');
            setTimeout(() => toast.classList.remove('visible'), 2500);
        }

        function copyToClipboard(text, btn) {
            navigator.clipboard.writeText(text).then(() => {
                if (btn) {
                    btn.classList.add('copied');
                    btn.textContent = '‚úì Copied';
                    setTimeout(() => {
                        btn.classList.remove('copied');
                        btn.textContent = 'üìã Copy';
                    }, 2000);
                }
                showToast('Copied to clipboard!');
            });
        }

        // =====================================================
        // TAB NAVIGATION
        // =====================================================
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
            });
        });

        // =====================================================
        // MESSAGE ANALYZER
        // =====================================================
        function analyzeMessage() {
            const message = document.getElementById('customerMessage').value;
            if (!message.trim()) {
                showToast('Please paste a customer message first');
                return;
            }

            const extracted = extractInfo(message);
            const matches = findMatches(extracted, message);

            displayResults(extracted, matches);
        }

        function extractInfo(message) {
            const info = {
                errorCode: null,
                errorKey: null,
                errorMessage: null,
                httpStatus: null,
                endpoint: null,
                context: []
            };

            // Look for error_code
            const codeMatch = message.match(/"error_code"\s*:\s*(\d+)/i);
            if (codeMatch) info.errorCode = parseInt(codeMatch[1]);

            // Look for code (string key)
            const keyMatch = message.match(/"code"\s*:\s*"([^"]+)"/i);
            if (keyMatch) info.errorKey = keyMatch[1];

            // Look for error message
            const msgMatch = message.match(/"error"\s*:\s*"([^"]+)"/i);
            if (msgMatch) info.errorMessage = msgMatch[1];

            // Look for HTTP status
            const httpMatch = message.match(/\b(400|401|403|404|429|500|502|503)\b/);
            if (httpMatch) info.httpStatus = httpMatch[1];

            // Look for endpoints
            const endpointMatch = message.match(/\/v[12]\/[\w\-\/]+/gi);
            if (endpointMatch) info.endpoint = endpointMatch[0];

            // Extract context keywords
            const contextKeywords = [
                'task', 'project', 'time entry', 'activity', 'user', 'team',
                'integration', 'Jira', 'Redmine', 'Asana', 'Trello', 'GitHub',
                'rate', 'limit', 'permission', 'access', 'authorization',
                'create', 'update', 'delete', 'sync', 'webhook', 'timesheet'
            ];

            const lowerMessage = message.toLowerCase();
            for (const keyword of contextKeywords) {
                if (lowerMessage.includes(keyword.toLowerCase())) {
                    info.context.push(keyword);
                }
            }

            return info;
        }

        function findMatches(extracted, message) {
            const matches = [];
            const lowerMessage = message.toLowerCase();

            // Exact match by error code
            if (extracted.errorCode) {
                const exactMatch = errorCodes.find(e => e.code === extracted.errorCode);
                if (exactMatch) {
                    matches.push({ ...exactMatch, matchType: 'exact' });
                    trackError(exactMatch.code);
                }
            }

            // Match by key
            if (extracted.errorKey && matches.length === 0) {
                const keyMatch = errorCodes.find(e => 
                    e.key.toLowerCase().includes(extracted.errorKey.toLowerCase()) ||
                    extracted.errorKey.toLowerCase().includes(e.key.toLowerCase())
                );
                if (keyMatch && !matches.find(m => m.code === keyMatch.code)) {
                    matches.push({ ...keyMatch, matchType: 'exact' });
                    trackError(keyMatch.code);
                }
            }

            // Find related errors based on context
            if (extracted.context.length > 0) {
                for (const error of errorCodes) {
                    if (matches.find(m => m.code === error.code)) continue;

                    const errorText = `${error.key} ${error.message}`.toLowerCase();
                    let relevance = 0;

                    for (const ctx of extracted.context) {
                        if (errorText.includes(ctx.toLowerCase())) relevance++;
                    }

                    if (lowerMessage.includes(error.message.toLowerCase().substring(0, 30))) {
                        relevance += 3;
                    }

                    if (relevance >= 2) {
                        matches.push({ ...error, matchType: 'related', relevance });
                    }
                }
            }

            matches.sort((a, b) => {
                if (a.matchType === 'exact' && b.matchType !== 'exact') return -1;
                if (a.matchType !== 'exact' && b.matchType === 'exact') return 1;
                return (b.relevance || 0) - (a.relevance || 0);
            });

            return matches.slice(0, 5);
        }

        function displayResults(extracted, matches) {
            document.getElementById('noAnalysis').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';

            // Extracted info
            let infoHtml = '<div class="info-grid">';
            infoHtml += `<div class="info-card ${extracted.errorCode ? '' : 'empty'}">
                <div class="info-label">Error Code</div>
                <div class="info-value">${extracted.errorCode || '‚Äî'}</div>
            </div>`;
            infoHtml += `<div class="info-card ${extracted.errorKey ? '' : 'empty'}">
                <div class="info-label">Error Key</div>
                <div class="info-value">${extracted.errorKey || '‚Äî'}</div>
            </div>`;
            infoHtml += `<div class="info-card ${extracted.httpStatus ? '' : 'empty'}">
                <div class="info-label">HTTP Status</div>
                <div class="info-value">${extracted.httpStatus || '‚Äî'}</div>
            </div>`;
            infoHtml += `<div class="info-card ${extracted.endpoint ? '' : 'empty'}">
                <div class="info-label">Endpoint</div>
                <div class="info-value">${extracted.endpoint || '‚Äî'}</div>
            </div>`;
            if (extracted.context.length > 0) {
                infoHtml += `<div class="info-card" style="grid-column: 1 / -1;">
                    <div class="info-label">Context Keywords</div>
                    <div class="info-value text">${extracted.context.join(', ')}</div>
                </div>`;
            }
            infoHtml += '</div>';
            document.getElementById('extractedInfo').innerHTML = infoHtml;

            // Matched errors
            if (matches.length === 0) {
                document.getElementById('matchedErrors').innerHTML = `
                    <div class="no-results">
                        <div class="icon">üîç</div>
                        <p>No matching errors found. Try the Error Browser to search manually.</p>
                    </div>`;
                return;
            }

            let matchHtml = '';
            for (const match of matches) {
                const category = getCategory(match.code);
                const guidance = supportGuidance[match.code];

                matchHtml += `
                    <div class="match-card ${match.matchType === 'exact' ? 'exact' : ''} cat-${category}">
                        <div class="match-header">
                            <div class="match-codes">
                                <span class="match-code">${match.code}</span>
                                <span class="match-key">${match.key}</span>
                                <span class="match-badge ${match.matchType === 'exact' ? 'badge-exact' : 'badge-related'}">
                                    ${match.matchType === 'exact' ? 'Exact' : 'Related'}
                                </span>
                            </div>
                            <span class="category-badge">${getCategoryName(category)}</span>
                        </div>
                        <div class="match-message">${match.message}</div>
                        ${guidance ? `
                            <div class="guidance-box">
                                <div class="guidance-header">üí° ${guidance.title}</div>
                                <p class="guidance-text">${guidance.guidance}</p>
                                ${guidance.steps ? `<ul class="guidance-steps">${guidance.steps.map(s => `<li>${s}</li>`).join('')}</ul>` : ''}
                            </div>
                            ${guidance.template ? `
                                <div class="response-template">
                                    <div class="response-header">
                                        <span class="response-title">üìù Response Template</span>
                                        <button class="btn btn-copy btn-small" onclick="copyToClipboard(\`${guidance.template.replace(/`/g, '\\`')}\`, this)">üìã Copy</button>
                                    </div>
                                    <div class="response-body">${guidance.template}</div>
                                </div>
                            ` : ''}
                        ` : `
                            <div class="no-guidance">
                                ‚ö†Ô∏è No guidance available for error ${match.code}. Check the Error Browser for similar errors.
                            </div>
                        `}
                    </div>`;
            }
            document.getElementById('matchedErrors').innerHTML = matchHtml;
            renderUsageStats();
        }

        function clearAnalysis() {
            document.getElementById('customerMessage').value = '';
            document.getElementById('noAnalysis').style.display = 'block';
            document.getElementById('resultsSection').style.display = 'none';
        }

        // =====================================================
        // ERROR BROWSER
        // =====================================================
        function filterErrors() {
            renderErrorGrid();
        }

        function setCategory(category) {
            currentCategory = category;
            document.querySelectorAll('.filter-chip').forEach(chip => {
                chip.classList.toggle('active', chip.dataset.category === category);
            });
            renderErrorGrid();
        }

        function renderErrorGrid() {
            const search = document.getElementById('errorSearch').value.toLowerCase();
            
            let filtered = errorCodes.filter(error => {
                if (currentCategory !== 'all' && getCategory(error.code) !== currentCategory) return false;
                if (search) {
                    const searchText = `${error.code} ${error.key} ${error.message}`.toLowerCase();
                    return searchText.includes(search);
                }
                return true;
            });

            document.getElementById('errorCount').textContent = `${filtered.length} errors`;

            if (filtered.length === 0) {
                document.getElementById('errorGrid').innerHTML = `
                    <div class="no-results" style="grid-column: 1 / -1;">
                        <div class="icon">üîç</div>
                        <p>No errors match your search</p>
                    </div>`;
                return;
            }

            let html = '';
            for (const error of filtered) {
                const category = getCategory(error.code);
                const hasGuidance = supportGuidance[error.code];
                
                html += `
                    <div class="error-card cat-${category} ${hasGuidance ? 'has-guidance' : ''}" onclick="showErrorDetail(${error.code})">
                        <div class="error-card-header">
                            <div>
                                <div class="error-code">${error.code}</div>
                                <div class="error-key">${error.key}</div>
                            </div>
                            <span class="category-badge">${getCategoryName(category)}</span>
                        </div>
                        <div class="error-message">${error.message}</div>
                    </div>`;
            }
            document.getElementById('errorGrid').innerHTML = html;
        }

        function showErrorDetail(code) {
            const error = errorCodes.find(e => e.code === code);
            if (!error) return;

            const category = getCategory(code);
            const guidance = supportGuidance[code];

            document.getElementById('modalTitle').textContent = `Error ${code}`;
            document.getElementById('modalBody').innerHTML = `
                <div class="match-card cat-${category}">
                    <div class="match-header">
                        <div class="match-codes">
                            <span class="match-code">${error.code}</span>
                            <span class="match-key">${error.key}</span>
                        </div>
                        <span class="category-badge">${getCategoryName(category)}</span>
                    </div>
                    <div class="match-message">${error.message}</div>
                    ${guidance ? `
                        <div class="guidance-box">
                            <div class="guidance-header">üí° ${guidance.title}</div>
                            <p class="guidance-text">${guidance.guidance}</p>
                            ${guidance.steps ? `<ul class="guidance-steps">${guidance.steps.map(s => `<li>${s}</li>`).join('')}</ul>` : ''}
                        </div>
                        ${guidance.template ? `
                            <div class="response-template">
                                <div class="response-header">
                                    <span class="response-title">üìù Response Template</span>
                                    <button class="btn btn-copy btn-small" onclick="copyToClipboard(\`${guidance.template.replace(/`/g, '\\`')}\`, this)">üìã Copy</button>
                                </div>
                                <div class="response-body">${guidance.template}</div>
                            </div>
                        ` : ''}
                    ` : `
                        <div class="no-guidance">
                            ‚ö†Ô∏è No support guidance available for this error yet.
                        </div>
                    `}
                </div>`;
            document.getElementById('errorModal').classList.add('visible');
        }

        function closeModal() {
            document.getElementById('errorModal').classList.remove('visible');
        }

        // =====================================================
        // QUICK REFERENCE
        // =====================================================
        function renderCommonErrors() {
            const commonCodes = [11000, 10001, 13000, 14001, 12000, 14403];
            let html = '';
            
            for (const code of commonCodes) {
                const error = errorCodes.find(e => e.code === code);
                if (!error) continue;
                
                const category = getCategory(code);
                const guidance = supportGuidance[code];
                
                html += `
                    <div class="error-card cat-${category}" style="margin-bottom: 12px; cursor: pointer;" onclick="showErrorDetail(${code})">
                        <div class="error-card-header">
                            <div>
                                <div class="error-code">${error.code}</div>
                                <div class="error-key">${error.key}</div>
                            </div>
                            <span class="category-badge">${getCategoryName(category)}</span>
                        </div>
                        <div class="error-message">${error.message}</div>
                        ${guidance ? `<div style="margin-top: 8px; font-size: 0.85rem; color: var(--primary);">üí° ${guidance.title}</div>` : ''}
                    </div>`;
            }
            document.getElementById('commonErrors').innerHTML = html;
        }

        function renderResponseTemplates() {
            let html = '';
            for (const tpl of responseTemplates) {
                html += `
                    <div class="response-template" style="margin-bottom: 16px;">
                        <div class="response-header">
                            <span class="response-title">${tpl.title}</span>
                            <button class="btn btn-copy btn-small" onclick="copyToClipboard(\`${tpl.template.replace(/`/g, '\\`')}\`, this)">üìã Copy</button>
                        </div>
                        <div class="response-body">${tpl.template}</div>
                    </div>`;
            }
            document.getElementById('responseTemplates').innerHTML = html;
        }

        // =====================================================
        // USAGE STATS
        // =====================================================
        function trackError(code) {
            const stats = JSON.parse(localStorage.getItem('hubstaffErrorStats') || '{}');
            stats[code] = (stats[code] || 0) + 1;
            localStorage.setItem('hubstaffErrorStats', JSON.stringify(stats));
        }

        function renderUsageStats() {
            const stats = JSON.parse(localStorage.getItem('hubstaffErrorStats') || '{}');
            const entries = Object.entries(stats).sort((a, b) => b[1] - a[1]).slice(0, 5);
            
            if (entries.length === 0) {
                document.getElementById('usagePanel').style.display = 'none';
                return;
            }
            
            document.getElementById('usagePanel').style.display = 'block';
            
            let html = '';
            for (const [code, count] of entries) {
                const error = errorCodes.find(e => e.code === parseInt(code));
                html += `
                    <div class="usage-item">
                        <span><span class="usage-code">${code}</span> ‚Äî ${error ? error.key : 'unknown'}</span>
                        <span class="usage-count">${count}√ó</span>
                    </div>`;
            }
            document.getElementById('usageList').innerHTML = html;
        }

        function clearUsageStats() {
            if (confirm('Clear all usage statistics?')) {
                localStorage.removeItem('hubstaffErrorStats');
                renderUsageStats();
                showToast('Statistics cleared');
            }
        }

        // =====================================================
        // HELP MODAL
        // =====================================================
        function openHelpModal() {
            document.getElementById('helpModal').classList.add('visible');
        }

        function closeHelpModal() {
            document.getElementById('helpModal').classList.remove('visible');
        }

        function showHelpTab(tabId) {
            document.querySelectorAll('.help-nav-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            document.querySelectorAll('.help-tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById('help-' + tabId).classList.add('active');
        }

        // =====================================================
        // EVENT LISTENERS & INIT
        // =====================================================
        document.getElementById('errorModal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('errorModal')) closeModal();
        });

        document.getElementById('helpModal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('helpModal')) closeHelpModal();
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
                closeHelpModal();
            }
        });

        // Initialize
        renderErrorGrid();
        renderUsageStats();
        renderCommonErrors();
        renderResponseTemplates();
        
        // Count guidance entries
        document.getElementById('guidanceCount').textContent = Object.keys(supportGuidance).length;
    </script>
</body>
</html>
